<!DOCTYPE html>
<html lang="ja">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<% rows.forEach(function(row) { %>
		<title><%= row.shopName %>の詳細情報</title>
		<link rel="stylesheet" href="/styles/menu.css" type="text/css" />
	</head>
	<body>
		<h1><div class="title"><%= row.shopName %>の詳細情報</div></h1>
		<div class="picture">
			<div class="item">
				<p class="menImage">
					<img src="/upload/<%= row.image %>" fileId="<%=row.image %>" alt="" width="auto" height="400" />
				</p>
			</div>
		</div> 
			<button id="deleteButton" dataId="<%= row.id %>" fileId="<%= row.image %>">削除</button>
		<div class="shop">
			<h1>店名：<%= row.shopName %></h1>
		</div>

		<div class="container">
			<div class="photo"></div>
			<div class="text-container">
				<div class="text">
					<h3><p><%= row.comment %></p></h3>
				</div>
				<div class="total">
					<h1>合計</h1>
					<h3><p><%= row.men + row.soup + row.topping %></p></h3>
				</div>
				<div class="point">
					<h2><p>麺</p></h2>
					<h3><p><%= row.men %></p></h3>
					<h2><p>スープ</p></h2>
					<h3><p><%= row.soup %></p></h3>
					<h2><p>トッピング</p></h2>
					<h3><p><%= row.topping %></p></h3>
				</div>
			</div>
		</div>
		<% }) %>
		<script>
			const deleteButton = document.getElementById('deleteButton');
			deleteButton.addEventListener('click', function() {
				const idToDelete = this.getAttribute('dataId');
				const deleteFile = this.getAttribute('fileId');
			// 追加: 確認ダイアログ表示
			if (!confirm('本当に削除してもいいですか？')) {
				return; // 「Cancel」を選択した場合、以降の処理はキャンセルされます
			}
			fetch(`/menu/delete-file/${deleteFile}`, {
						method: 'DELETE',
						body: JSON.stringify({ deleteFile }),
						headers: {
							'Content-Type': 'application/json',
						},
					})
					.then(response => {
						if (response.status === 200) {
							fetch(`/menu/${idToDelete}`, {
							method: 'DELETE',
							body: JSON.stringify({ deleteFile }), // deleteFile を送信
							headers: {
								'Content-Type': 'application/json',
							},
						})
						// 削除が成功したときの処理
						} else {
						// 削除が失敗したときの処理
						alert('データの削除に失敗しました。')
						}
					})
			.catch(error => {
				console.error('エラー: ' + error);
			});
			});
		</script>
	</body>
</html>
