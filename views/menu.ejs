<!DOCTYPE html>
<html lang="ja">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<% rows.forEach(function(row) { %>
		<title><%= row.shopName %>の詳細情報</title>
		<link rel="stylesheet" href="/styles/menu.css" type="text/css" />
	</head>
	<body>
		<div class="header">
			<div class="title"><h1><%= row.shopName %>の詳細情報</h1></div>
			<div class="buttonDiv">
				<button id="deleteButton" class="deleteButton" dataId="<%= row.id %>">削除</button>
			</div>
		</div>
		<div class="main">
			<div class="shop">
				<h1>店名：<%= row.shopName %></h1>
			</div>
			<div class="picture">
				<img src="/upload/<%= row.image %>" alt="" width="auto" height="400" />
			</div>
		</div>

		<div class="container">
			<div class="point">
				<p class="pointItem">麺: <%= row.men %></p>
				<p class="pointItem">スープ: <%= row.soup %></p>
				<p class="pointItem">トッピング: <%= row.topping %></p>
			</div>
			<div class="total">
				<h3>
					<% let fiveStarRate =Math.ceil((row.men + row.soup + row.topping) / 300 / 0.2)
					%>
					<p class="fiveStarRate">
						<img src="/pictures/fiveStars.png" <% if (fiveStarRate === 1) { %>
						id="score1" <% } else if (fiveStarRate === 2) { %> id="score2" <% } else if
						(fiveStarRate === 3) { %> id="score3" <% } else if (fiveStarRate === 4) { %>
						id="score4" <% } else if (fiveStarRate === 5) { %> id="score5" <% } %> />
					</p>
				</h3>
			</div>
			<div class="text">
				<h2>コメント</h2>
				<p><%= row.comment %></p>
			</div>
		</div>
		<% }) %>
		<script>
			document.getElementById("deleteButton").addEventListener("click", function () {
				const idToDelete = this.getAttribute("dataId");

				// 追加: 確認ダイアログ表示
				if (!confirm("本当に消してもいいですか？")) {
					return;
				}

				fetch(`/menu/${idToDelete}`, {
					method: "DELETE",
				})
					.then((response) => {
						if (response.status === 200) {
							alert("データが削除されました。");
							// 必要に応じてリダイレクトなどのアクションを追加
						} else {
							alert("データの削除に失敗しました。");
						}
					})
					.catch((error) => {
						console.error("エラー: " + error);
					});
			});
		</script>
	</body>
</html>
